<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="light">
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="O3 Cache Block" />
<meta property="og:locale" content="en" />
<meta name="description" content="Cache internal class hierarchies in GEM5 1 2 3 4 5 6 7 8 92 /** 93 * A basic cache interface. Implements some common functions for speed. 94 */ 95 class BaseCache : public ClockedObject 96 { ...... 349 /** Tag and data Storage */ 350 BaseTags *tags;" />
<meta property="og:description" content="Cache internal class hierarchies in GEM5 1 2 3 4 5 6 7 8 92 /** 93 * A basic cache interface. Implements some common functions for speed. 94 */ 95 class BaseCache : public ClockedObject 96 { ...... 349 /** Tag and data Storage */ 350 BaseTags *tags;" />
<link rel="canonical" href="http://localhost:4000/posts/O3-cache-block/" />
<meta property="og:url" content="http://localhost:4000/posts/O3-cache-block/" />
<meta property="og:site_name" content="Ruach" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-06-11T00:00:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="O3 Cache Block" />
<meta name="twitter:site" content="@ruach_lee" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-06-11T00:00:00-04:00","datePublished":"2021-06-11T00:00:00-04:00","description":"Cache internal class hierarchies in GEM5 1 2 3 4 5 6 7 8 92 /** 93 * A basic cache interface. Implements some common functions for speed. 94 */ 95 class BaseCache : public ClockedObject 96 { ...... 349 /** Tag and data Storage */ 350 BaseTags *tags;","headline":"O3 Cache Block","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/O3-cache-block/"},"url":"http://localhost:4000/posts/O3-cache-block/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>O3 Cache Block | Ruach
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Ruach">
<meta name="application-name" content="Ruach">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
        
        <img src="/assets/img/jaehyuk.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <h1 class="site-title">
      <a href="/">Ruach</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Security Researcher at Gatech</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['jaehyuk','gatech.edu'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/jaehyuk-lee-29b33b121/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
      

      
        <a
          href="https://github.com/Ruach"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://stackoverflow.com/users/4460514/ruach?tab=profile"
          aria-label="stack-overflow"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-stack-overflow"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>O3 Cache Block</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>O3 Cache Block</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1623384000"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jun 11, 2021
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://ruach.github.io">Jaehyuk Lee</a>
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1614 words"
>
  <em>8 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    
<h2 id="cache-internal-class-hierarchies-in-gem5"><span class="me-2">Cache internal class hierarchies in GEM5</span><a href="#cache-internal-class-hierarchies-in-gem5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>  <span class="mi">92</span> <span class="cm">/**
  93  * A basic cache interface. Implements some common functions for speed.
  94  */</span>
  <span class="mi">95</span> <span class="k">class</span> <span class="nc">BaseCache</span> <span class="o">:</span> <span class="k">public</span> <span class="n">ClockedObject</span>
  <span class="mi">96</span> <span class="p">{</span>
<span class="p">......</span>
 <span class="mi">349</span>     <span class="cm">/** Tag and data Storage */</span>
 <span class="mi">350</span>     <span class="n">BaseTags</span> <span class="o">*</span><span class="n">tags</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre> <span class="mi">70</span> <span class="cm">/**
 71  * A common base class of Cache tagstore objects.
 72  */</span>
 <span class="mi">73</span> <span class="k">class</span> <span class="nc">BaseTags</span> <span class="o">:</span> <span class="k">public</span> <span class="n">ClockedObject</span>
 <span class="mi">74</span> <span class="p">{</span>
<span class="p">......</span>
 <span class="mi">88</span>     <span class="cm">/** Indexing policy */</span>
 <span class="mi">89</span>     <span class="n">BaseIndexingPolicy</span> <span class="o">*</span><span class="n">indexingPolicy</span><span class="p">;</span>
<span class="p">......</span>
<span class="mi">102</span>     <span class="cm">/** The data blocks, 1 per cache block. */</span>
<span class="mi">103</span>     <span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="p">[]</span><span class="o">&gt;</span> <span class="n">dataBlks</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The main cache structure called BaseCache contains member field tags (object of BaseTags)
The BaseTags class contains the actual data blocks for maintaining data to the cache.
Also, it has BaseIndexingPolicy that determines which entry should be selected or evicted 
as a result of cache access operations (including cache read and write).</p>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre><span class="mi">60</span> <span class="cm">/**
 61  * A common base class for indexing table locations. Classes that inherit
 62  * from it determine hash functions that should be applied based on the set
 63  * and way. These functions are then applied to re-map the original values.
 64  * @sa  \ref gem5MemorySystem "gem5 Memory System"
 65  */</span>
 <span class="mi">66</span> <span class="k">class</span> <span class="nc">BaseIndexingPolicy</span> <span class="o">:</span> <span class="k">public</span> <span class="n">SimObject</span>
 <span class="mi">67</span> <span class="p">{</span>
 <span class="mi">68</span>   <span class="k">protected</span><span class="o">:</span>
 <span class="mi">69</span>     <span class="cm">/**
 70      * The associativity.
 71      */</span>
 <span class="mi">72</span>     <span class="k">const</span> <span class="kt">unsigned</span> <span class="n">assoc</span><span class="p">;</span>
 <span class="mi">73</span> 
 <span class="mi">74</span>     <span class="cm">/**
 75      * The number of sets in the cache.
 76      */</span>
 <span class="mi">77</span>     <span class="k">const</span> <span class="kt">uint32_t</span> <span class="n">numSets</span><span class="p">;</span>
 <span class="mi">78</span> 
 <span class="mi">79</span>     <span class="cm">/**
 80      * The amount to shift the address to get the set.
 81      */</span>
 <span class="mi">82</span>     <span class="k">const</span> <span class="kt">int</span> <span class="n">setShift</span><span class="p">;</span>
 <span class="mi">83</span> 
 <span class="mi">84</span>     <span class="cm">/**
 85      * Mask out all bits that aren't part of the set index.
 86      */</span>
 <span class="mi">87</span>     <span class="k">const</span> <span class="kt">unsigned</span> <span class="n">setMask</span><span class="p">;</span>
 <span class="mi">88</span> 
 <span class="mi">89</span>     <span class="cm">/**
 90      * The cache sets.
 91      */</span>
 <span class="mi">92</span>     <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ReplaceableEntry</span><span class="o">*&gt;&gt;</span> <span class="n">sets</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Note that the BaseIndexingPolicy contains sets 
consisting of multiple entries of ReplaceableEntry. 
The CacheBlk will be stored in the sets member field
because the CacheBlk is a child of ReplaceableEntry class. 
Also, sets can be indexed with set and way to provide 
nomenclature of the cache.</p>

<h3 id="cacheblk-the-basic-unit-of-each-cache-block-entry"><span class="me-2">CacheBlk the basic unit of each cache block entry</span><a href="#cacheblk-the-basic-unit-of-each-cache-block-entry" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre> <span class="mi">65</span> <span class="cm">/**
 66  * A Basic Cache block.
 67  * Contains information regarding its coherence, prefetching status, as
 68  * well as a pointer to its data.
 69  */</span>
 <span class="mi">70</span> <span class="k">class</span> <span class="nc">CacheBlk</span> <span class="o">:</span> <span class="k">public</span> <span class="n">TaggedEntry</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre> <span class="mi">41</span> <span class="cm">/**
 42  * A tagged entry is an entry containing a tag. Each tag is accompanied by a
 43  * secure bit, which informs whether it belongs to a secure address space.
 44  * A tagged entry's contents are only relevant if it is marked as valid.
 45  */</span>
 <span class="mi">46</span> <span class="k">class</span> <span class="nc">TaggedEntry</span> <span class="o">:</span> <span class="k">public</span> <span class="n">ReplaceableEntry</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre> <span class="mi">53</span> <span class="cm">/**
 54  * A replaceable entry is a basic entry in a 2d table-like structure that needs
 55  * to have replacement functionality. This entry is located in a specific row
 56  * and column of the table (set and way in cache nomenclature), which are
 57  * stored within the entry itself.
 58  *
 59  * It contains the replacement data pointer, which must be instantiated by the
 60  * replacement policy before being used.
 61  * @sa Replacement Policies
 62  */</span>
 <span class="mi">63</span> <span class="k">class</span> <span class="nc">ReplaceableEntry</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The cache block maintains three important data related with one cache entry:
coherence information, prefetching status, and pointer to the data.
Therefore, let’s take a look at the structure and interface 
required for managing those information.
<strong>Remaining question: Then where the data exactly is stored? in the CacheBlk object? or 
in the dataBlks member field of the tags?</strong></p>

<h2 id="cache-management"><span class="me-2">Cache management</span><a href="#cache-management" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="initializing-cache-blocks"><span class="me-2">Initializing cache blocks</span><a href="#initializing-cache-blocks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre></td><td class="rouge-code"><pre>  <span class="mi">79</span> <span class="n">BaseCache</span><span class="o">::</span><span class="n">BaseCache</span><span class="p">(</span><span class="k">const</span> <span class="n">BaseCacheParams</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">blk_size</span><span class="p">)</span>
  <span class="mi">80</span>     <span class="o">:</span> <span class="n">ClockedObject</span><span class="p">(</span><span class="n">p</span><span class="p">),</span>
  <span class="mi">81</span>       <span class="nf">cpuSidePort</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">".cpu_side_port"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="s">"CpuSidePort"</span><span class="p">),</span>
  <span class="mi">82</span>       <span class="n">memSidePort</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">".mem_side_port"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="s">"MemSidePort"</span><span class="p">),</span>
  <span class="mi">83</span>       <span class="n">mshrQueue</span><span class="p">(</span><span class="s">"MSHRs"</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">mshrs</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">demand_mshr_reserve</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">),</span>
  <span class="mi">84</span>       <span class="n">writeBuffer</span><span class="p">(</span><span class="s">"write buffer"</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">write_buffers</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">mshrs</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">),</span>
  <span class="mi">85</span>       <span class="n">tags</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">tags</span><span class="p">),</span>
  <span class="mi">86</span>       <span class="n">compressor</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">compressor</span><span class="p">),</span>
  <span class="mi">87</span>       <span class="n">prefetcher</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">prefetcher</span><span class="p">),</span>
  <span class="mi">88</span>       <span class="n">writeAllocator</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">write_allocator</span><span class="p">),</span>
  <span class="mi">89</span>       <span class="n">writebackClean</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">writeback_clean</span><span class="p">),</span>
  <span class="mi">90</span>       <span class="n">tempBlockWriteback</span><span class="p">(</span><span class="nb">nullptr</span><span class="p">),</span>
  <span class="mi">91</span>       <span class="n">writebackTempBlockAtomicEvent</span><span class="p">([</span><span class="k">this</span><span class="p">]{</span> <span class="n">writebackTempBlockAtomic</span><span class="p">();</span> <span class="p">},</span>
  <span class="mi">92</span>                                     <span class="nf">name</span><span class="p">(),</span> <span class="nb">false</span><span class="p">,</span>
  <span class="mi">93</span>                                     <span class="n">EventBase</span><span class="o">::</span><span class="n">Delayed_Writeback_Pri</span><span class="p">),</span>
  <span class="mi">94</span>       <span class="n">blkSize</span><span class="p">(</span><span class="n">blk_size</span><span class="p">),</span>
  <span class="mi">95</span>       <span class="n">lookupLatency</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">tag_latency</span><span class="p">),</span>
  <span class="mi">96</span>       <span class="n">dataLatency</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">data_latency</span><span class="p">),</span>
  <span class="mi">97</span>       <span class="n">forwardLatency</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">tag_latency</span><span class="p">),</span>
  <span class="mi">98</span>       <span class="n">fillLatency</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">data_latency</span><span class="p">),</span>
  <span class="mi">99</span>       <span class="n">responseLatency</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">response_latency</span><span class="p">),</span>
 <span class="mi">100</span>       <span class="n">sequentialAccess</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">sequential_access</span><span class="p">),</span>
 <span class="mi">101</span>       <span class="n">numTarget</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">tgts_per_mshr</span><span class="p">),</span>
 <span class="mi">102</span>       <span class="n">forwardSnoops</span><span class="p">(</span><span class="nb">true</span><span class="p">),</span>
 <span class="mi">103</span>       <span class="n">clusivity</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">clusivity</span><span class="p">),</span>
 <span class="mi">104</span>       <span class="n">isReadOnly</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">is_read_only</span><span class="p">),</span>
 <span class="mi">105</span>       <span class="n">replaceExpansions</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">replace_expansions</span><span class="p">),</span>
 <span class="mi">106</span>       <span class="n">moveContractions</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">move_contractions</span><span class="p">),</span>
 <span class="mi">107</span>       <span class="n">blocked</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
 <span class="mi">108</span>       <span class="n">order</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
 <span class="mi">109</span>       <span class="n">noTargetMSHR</span><span class="p">(</span><span class="nb">nullptr</span><span class="p">),</span>
 <span class="mi">110</span>       <span class="n">missCount</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">max_miss_count</span><span class="p">),</span>
 <span class="mi">111</span>       <span class="n">addrRanges</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">addr_ranges</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">p</span><span class="p">.</span><span class="n">addr_ranges</span><span class="p">.</span><span class="n">end</span><span class="p">()),</span>
 <span class="mi">112</span>       <span class="n">system</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">system</span><span class="p">),</span>
 <span class="mi">113</span>       <span class="n">stats</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)</span>
 <span class="mi">114</span> <span class="p">{</span>
 <span class="mi">115</span>     <span class="c1">// the MSHR queue has no reserve entries as we check the MSHR</span>
 <span class="mi">116</span>     <span class="c1">// queue on every single allocation, whereas the write queue has</span>
 <span class="mi">117</span>     <span class="c1">// as many reserve entries as we have MSHRs, since every MSHR may</span>
 <span class="mi">118</span>     <span class="c1">// eventually require a writeback, and we do not check the write</span>
 <span class="mi">119</span>     <span class="c1">// buffer before committing to an MSHR</span>
 <span class="mi">120</span> 
 <span class="mi">121</span>     <span class="c1">// forward snoops is overridden in init() once we can query</span>
 <span class="mi">122</span>     <span class="c1">// whether the connected requestor is actually snooping or not</span>
 <span class="mi">123</span> 
 <span class="mi">124</span>     <span class="n">tempBlock</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TempCacheBlk</span><span class="p">(</span><span class="n">blkSize</span><span class="p">);</span>
 <span class="mi">125</span> 
 <span class="mi">126</span>     <span class="n">tags</span><span class="o">-&gt;</span><span class="n">tagsInit</span><span class="p">();</span>
 <span class="mi">127</span>     <span class="nf">if</span> <span class="p">(</span><span class="n">prefetcher</span><span class="p">)</span>
 <span class="mi">128</span>         <span class="n">prefetcher</span><span class="o">-&gt;</span><span class="n">setCache</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
 <span class="mi">129</span> 
 <span class="mi">130</span>     <span class="nf">fatal_if</span><span class="p">(</span><span class="n">compressor</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">dynamic_cast</span><span class="o">&lt;</span><span class="n">CompressedTags</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">tags</span><span class="p">),</span>
 <span class="mi">131</span>         <span class="s">"The tags of compressed cache %s must derive from CompressedTags"</span><span class="p">,</span>
 <span class="mi">132</span>         <span class="n">name</span><span class="p">());</span>
 <span class="mi">133</span>     <span class="nf">warn_if</span><span class="p">(</span><span class="o">!</span><span class="n">compressor</span> <span class="o">&amp;&amp;</span> <span class="k">dynamic_cast</span><span class="o">&lt;</span><span class="n">CompressedTags</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">tags</span><span class="p">),</span>
 <span class="mi">134</span>         <span class="s">"Compressed cache %s does not have a compression algorithm"</span><span class="p">,</span> <span class="n">name</span><span class="p">());</span>
 <span class="mi">135</span>     <span class="k">if</span> <span class="p">(</span><span class="n">compressor</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>When the BaseCache is constructed, 
it initializes its member field tags by passing the parameters
required for initializing the BaseTags class.
Because we are currently dealing with the BaseSetAssoc class which 
inherits the BaseTags class,
its constructor will be invoked first instead of the BaseTags’s constructor.</p>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre> <span class="mi">55</span> <span class="n">BaseSetAssoc</span><span class="o">::</span><span class="n">BaseSetAssoc</span><span class="p">(</span><span class="k">const</span> <span class="n">Params</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">)</span>
 <span class="mi">56</span>     <span class="o">:</span><span class="n">BaseTags</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">allocAssoc</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">assoc</span><span class="p">),</span> <span class="n">blks</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">size</span> <span class="o">/</span> <span class="n">p</span><span class="p">.</span><span class="n">block_size</span><span class="p">),</span>
 <span class="mi">57</span>      <span class="nf">sequentialAccess</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">sequential_access</span><span class="p">),</span>
 <span class="mi">58</span>      <span class="n">replacementPolicy</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">replacement_policy</span><span class="p">)</span>
 <span class="mi">59</span> <span class="p">{</span>
 <span class="mi">60</span>     <span class="c1">// There must be a indexing policy</span>
 <span class="mi">61</span>     <span class="n">fatal_if</span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">.</span><span class="n">indexing_policy</span><span class="p">,</span> <span class="s">"An indexing policy is required"</span><span class="p">);</span>
 <span class="mi">62</span> 
 <span class="mi">63</span>     <span class="c1">// Check parameters</span>
 <span class="mi">64</span>     <span class="nf">if</span> <span class="p">(</span><span class="n">blkSize</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="o">||</span> <span class="o">!</span><span class="n">isPowerOf2</span><span class="p">(</span><span class="n">blkSize</span><span class="p">))</span> <span class="p">{</span>
 <span class="mi">65</span>         <span class="n">fatal</span><span class="p">(</span><span class="s">"Block size must be at least 4 and a power of 2"</span><span class="p">);</span>
 <span class="mi">66</span>     <span class="p">}</span>
 <span class="mi">67</span> <span class="p">}</span>
 <span class="mi">68</span>
 <span class="mi">69</span> <span class="kt">void</span>
 <span class="mi">70</span> <span class="n">BaseSetAssoc</span><span class="o">::</span><span class="n">tagsInit</span><span class="p">()</span>
 <span class="mi">71</span> <span class="p">{</span>
 <span class="mi">72</span>     <span class="c1">// Initialize all blocks</span>
 <span class="mi">73</span>     <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="n">blk_index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">blk_index</span> <span class="o">&lt;</span> <span class="n">numBlocks</span><span class="p">;</span> <span class="n">blk_index</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
 <span class="mi">74</span>         <span class="c1">// Locate next cache block</span>
 <span class="mi">75</span>         <span class="n">CacheBlk</span><span class="o">*</span> <span class="n">blk</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">blks</span><span class="p">[</span><span class="n">blk_index</span><span class="p">];</span>
 <span class="mi">76</span> 
 <span class="mi">77</span>         <span class="c1">// Link block to indexing policy</span>
 <span class="mi">78</span>         <span class="n">indexingPolicy</span><span class="o">-&gt;</span><span class="n">setEntry</span><span class="p">(</span><span class="n">blk</span><span class="p">,</span> <span class="n">blk_index</span><span class="p">);</span>
 <span class="mi">79</span> 
 <span class="mi">80</span>         <span class="c1">// Associate a data chunk to the block</span>
 <span class="mi">81</span>         <span class="n">blk</span><span class="o">-&gt;</span><span class="n">data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">dataBlks</span><span class="p">[</span><span class="n">blkSize</span><span class="o">*</span><span class="n">blk_index</span><span class="p">];</span>
 <span class="mi">82</span> 
 <span class="mi">83</span>         <span class="c1">// Associate a replacement data entry to the block</span>
 <span class="mi">84</span>         <span class="n">blk</span><span class="o">-&gt;</span><span class="n">replacementData</span> <span class="o">=</span> <span class="n">replacementPolicy</span><span class="o">-&gt;</span><span class="n">instantiateEntry</span><span class="p">();</span>
 <span class="mi">85</span>     <span class="p">}</span>
 <span class="mi">86</span> <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>When the BaseSetAssoc is populated, it initializes the blk member field 
with (p.size / p.block_size) entries. 
After that, the constructor of the BaseCache invokes the tagsInit function
implemented in the BaseSetAssoc class. 
As shown in the above code, 
it select one CacheBlk from the blk memeber field of the BaseSetAssoc.</p>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre> <span class="mi">80</span> <span class="kt">void</span>
 <span class="mi">81</span> <span class="n">BaseIndexingPolicy</span><span class="o">::</span><span class="n">setEntry</span><span class="p">(</span><span class="n">ReplaceableEntry</span><span class="o">*</span> <span class="n">entry</span><span class="p">,</span> <span class="k">const</span> <span class="kt">uint64_t</span> <span class="n">index</span><span class="p">)</span>
 <span class="mi">82</span> <span class="p">{</span>
 <span class="mi">83</span>     <span class="c1">// Calculate set and way from entry index</span>
 <span class="mi">84</span>     <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">lldiv_t</span> <span class="n">div_result</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">div</span><span class="p">((</span><span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="n">index</span><span class="p">,</span> <span class="n">assoc</span><span class="p">);</span>
 <span class="mi">85</span>     <span class="k">const</span> <span class="kt">uint32_t</span> <span class="n">set</span> <span class="o">=</span> <span class="n">div_result</span><span class="p">.</span><span class="n">quot</span><span class="p">;</span>
 <span class="mi">86</span>     <span class="k">const</span> <span class="kt">uint32_t</span> <span class="n">way</span> <span class="o">=</span> <span class="n">div_result</span><span class="p">.</span><span class="n">rem</span><span class="p">;</span>
 <span class="mi">87</span> 
 <span class="mi">88</span>     <span class="c1">// Sanity check</span>
 <span class="mi">89</span>     <span class="n">assert</span><span class="p">(</span><span class="n">set</span> <span class="o">&lt;</span> <span class="n">numSets</span><span class="p">);</span>
 <span class="mi">90</span> 
 <span class="mi">91</span>     <span class="c1">// Assign a free pointer</span>
 <span class="mi">92</span>     <span class="n">sets</span><span class="p">[</span><span class="n">set</span><span class="p">][</span><span class="n">way</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="p">;</span>
 <span class="mi">93</span> 
 <span class="mi">94</span>     <span class="c1">// Inform the entry its position</span>
 <span class="mi">95</span>     <span class="n">entry</span><span class="o">-&gt;</span><span class="n">setPosition</span><span class="p">(</span><span class="n">set</span><span class="p">,</span> <span class="n">way</span><span class="p">);</span>
 <span class="mi">96</span> <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The setEntry function of the indexingPolicy will be invoked next 
so that it associates the CacheBlk in the Tag class 
to the sets member field of the indexingPolicy</p>

<h3 id="map-datablk-to-cacheblk"><span class="me-2">Map datablk to cacheblk</span><a href="#map-datablk-to-cacheblk" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>When the BaseSetAssoc object is constructed, 
it invoked its parent’s constructor BaseTags with the parameter.</p>
<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre> <span class="mi">61</span> <span class="n">BaseTags</span><span class="o">::</span><span class="n">BaseTags</span><span class="p">(</span><span class="k">const</span> <span class="n">Params</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">)</span>
 <span class="mi">62</span>     <span class="o">:</span> <span class="n">ClockedObject</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">blkSize</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">block_size</span><span class="p">),</span> <span class="n">blkMask</span><span class="p">(</span><span class="n">blkSize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
 <span class="mi">63</span>       <span class="nf">size</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">size</span><span class="p">),</span> <span class="n">lookupLatency</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">tag_latency</span><span class="p">),</span>
 <span class="mi">64</span>       <span class="n">system</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">system</span><span class="p">),</span> <span class="n">indexingPolicy</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">indexing_policy</span><span class="p">),</span>
 <span class="mi">65</span>       <span class="n">warmupBound</span><span class="p">((</span><span class="n">p</span><span class="p">.</span><span class="n">warmup_percentage</span><span class="o">/</span><span class="mf">100.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">size</span> <span class="o">/</span> <span class="n">p</span><span class="p">.</span><span class="n">block_size</span><span class="p">)),</span>
 <span class="mi">66</span>       <span class="n">warmedUp</span><span class="p">(</span><span class="nb">false</span><span class="p">),</span> <span class="n">numBlocks</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">size</span> <span class="o">/</span> <span class="n">p</span><span class="p">.</span><span class="n">block_size</span><span class="p">),</span>
 <span class="mi">67</span>       <span class="n">dataBlks</span><span class="p">(</span><span class="k">new</span> <span class="kt">uint8_t</span><span class="p">[</span><span class="n">p</span><span class="p">.</span><span class="n">size</span><span class="p">]),</span> <span class="c1">// Allocate data storage in one big chunk</span>
 <span class="mi">68</span>       <span class="n">stats</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)</span>
 <span class="mi">69</span> <span class="p">{</span>
 <span class="mi">70</span>     <span class="n">registerExitCallback</span><span class="p">([</span><span class="k">this</span><span class="p">]()</span> <span class="p">{</span> <span class="n">cleanupRefs</span><span class="p">();</span> <span class="p">});</span>
 <span class="mi">71</span> <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>You might remember that the BaseTags class contains dataBlks member field.
Here the constructor initializes the dataBlks to have 
(p.size / p.block_size) entries for storing the cache data. 
Note that the number of entries of the dataBlks and the blk are same
because one dataBlk is associated with one CacheBlk.</p>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre> <span class="mi">69</span> <span class="kt">void</span>
 <span class="mi">70</span> <span class="n">BaseSetAssoc</span><span class="o">::</span><span class="n">tagsInit</span><span class="p">()</span>
 <span class="mi">71</span> <span class="p">{</span>
 <span class="mi">72</span>     <span class="c1">// Initialize all blocks</span>
 <span class="mi">73</span>     <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="n">blk_index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">blk_index</span> <span class="o">&lt;</span> <span class="n">numBlocks</span><span class="p">;</span> <span class="n">blk_index</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
 <span class="mi">74</span>         <span class="c1">// Locate next cache block</span>
 <span class="mi">75</span>         <span class="n">CacheBlk</span><span class="o">*</span> <span class="n">blk</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">blks</span><span class="p">[</span><span class="n">blk_index</span><span class="p">];</span>
 <span class="mi">76</span>
 <span class="mi">77</span>         <span class="c1">// Link block to indexing policy</span>
 <span class="mi">78</span>         <span class="n">indexingPolicy</span><span class="o">-&gt;</span><span class="n">setEntry</span><span class="p">(</span><span class="n">blk</span><span class="p">,</span> <span class="n">blk_index</span><span class="p">);</span>
 <span class="mi">79</span>
 <span class="mi">80</span>         <span class="c1">// Associate a data chunk to the block</span>
 <span class="mi">81</span>         <span class="n">blk</span><span class="o">-&gt;</span><span class="n">data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">dataBlks</span><span class="p">[</span><span class="n">blkSize</span><span class="o">*</span><span class="n">blk_index</span><span class="p">];</span>
</pre></td></tr></tbody></table></code></div></div>

<p>When you go back to the tagsInit, 
you can find that one dataBlks having blkSize size 
is mapped to the one CacheBlk.
Because this CacheBlk is mapped to particular way of one set,
the data will be also associated with that cache entry.
To summary, the BaseCache maintains the tag.
And the tag provides cache storage and cacheblks to the 
BaseIndexingPolicy object.
Conceptually, the cache is maintained by the 
BaseIndexingPolicy class which maintains the cache
with set and ways indexing.</p>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    

    <!-- tags -->
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a
        href="https://twitter.com/intent/tweet?text=O3%20Cache%20Block%20-%20Ruach&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FO3-cache-block%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Twitter"
        target="_blank"
        rel="noopener"
        aria-label="Twitter"
      >
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a
        href="https://www.facebook.com/sharer/sharer.php?title=O3%20Cache%20Block%20-%20Ruach&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FO3-cache-block%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Facebook"
        target="_blank"
        rel="noopener"
        aria-label="Facebook"
      >
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a
        href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FO3-cache-block%2F&text=O3%20Cache%20Block%20-%20Ruach"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Telegram"
        target="_blank"
        rel="noopener"
        aria-label="Telegram"
      >
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

      

      <a
        href="https://www.linkedin.com/sharing/share-offsite/?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FO3-cache-block%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Linkedin"
        target="_blank"
        rel="noopener"
        aria-label="Linkedin"
      >
        <i class="fa-fw fab fa-linkedin"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get the last 5 posts from lastmod list. -->















              <!-- The trending tags list -->


















            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->

























            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/O3-cache-recv/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>O3 Cache Recv</p>
    </a>
  

  
    <a
      href="/posts/basecpu/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Basecpu</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    ©
    <time>2023</time>
    <a href="https://ruach.github.io">Jaehyuk Lee</a>.
    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->


















    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.21.2/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

