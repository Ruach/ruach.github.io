<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="light">
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Gem5 Interrupt Handling O3" />
<meta property="og:locale" content="en" />
<meta name="description" content="Interrupt makes the commit stage stop further instructions fetching 1 2 3 4 5 6 7 8 9 813 template &lt;class Impl&gt; 814 void 815 DefaultCommit&lt;Impl&gt;::commit() 816 { 817 if (FullSystem) { 818 // Check if we have a interrupt and get read to handle it 819 if (cpu-&gt;checkInterrupts(cpu-&gt;tcBase(0))) 820 propagateInterrupt(); 821 }" />
<meta property="og:description" content="Interrupt makes the commit stage stop further instructions fetching 1 2 3 4 5 6 7 8 9 813 template &lt;class Impl&gt; 814 void 815 DefaultCommit&lt;Impl&gt;::commit() 816 { 817 if (FullSystem) { 818 // Check if we have a interrupt and get read to handle it 819 if (cpu-&gt;checkInterrupts(cpu-&gt;tcBase(0))) 820 propagateInterrupt(); 821 }" />
<link rel="canonical" href="https://ruach.github.io/posts/gem5-interrupt-handling-o3/" />
<meta property="og:url" content="https://ruach.github.io/posts/gem5-interrupt-handling-o3/" />
<meta property="og:site_name" content="Ruach" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-12-25T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Gem5 Interrupt Handling O3" />
<meta name="twitter:site" content="@ruach_lee" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-12-25T00:00:00-05:00","datePublished":"2021-12-25T00:00:00-05:00","description":"Interrupt makes the commit stage stop further instructions fetching 1 2 3 4 5 6 7 8 9 813 template &lt;class Impl&gt; 814 void 815 DefaultCommit&lt;Impl&gt;::commit() 816 { 817 if (FullSystem) { 818 // Check if we have a interrupt and get read to handle it 819 if (cpu-&gt;checkInterrupts(cpu-&gt;tcBase(0))) 820 propagateInterrupt(); 821 }","headline":"Gem5 Interrupt Handling O3","mainEntityOfPage":{"@type":"WebPage","@id":"https://ruach.github.io/posts/gem5-interrupt-handling-o3/"},"url":"https://ruach.github.io/posts/gem5-interrupt-handling-o3/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Gem5 Interrupt Handling O3 | Ruach
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Ruach">
<meta name="application-name" content="Ruach">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
        
        <img src="/assets/img/jaehyuk.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <h1 class="site-title">
      <a href="/">Ruach</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Jaehyuk Lee</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['jaehyuk','gatech.edu'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/jaehyuk-lee-29b33b121/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
      

      
        <a
          href="https://github.com/Ruach"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://stackoverflow.com/users/4460514/ruach?tab=profile"
          aria-label="stack-overflow"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-stack-overflow"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>Gem5 Interrupt Handling O3</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Gem5 Interrupt Handling O3</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1640408400"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Dec 25, 2021
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://ruach.github.io">Jaehyuk Lee</a>
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1107 words"
>
  <em>6 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    
<h3 id="interrupt-makes-the-commit-stage-stop-further-instructions-fetching"><span class="me-2">Interrupt makes the commit stage stop further instructions fetching</span><a href="#interrupt-makes-the-commit-stage-stop-further-instructions-fetching" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre> <span class="mi">813</span> <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Impl</span><span class="p">&gt;</span>
 <span class="mi">814</span> <span class="kt">void</span>
 <span class="mi">815</span> <span class="n">DefaultCommit</span><span class="o">&lt;</span><span class="n">Impl</span><span class="o">&gt;::</span><span class="n">commit</span><span class="p">()</span>
 <span class="mi">816</span> <span class="p">{</span>
 <span class="mi">817</span>     <span class="k">if</span> <span class="p">(</span><span class="n">FullSystem</span><span class="p">)</span> <span class="p">{</span>
 <span class="mi">818</span>         <span class="c1">// Check if we have a interrupt and get read to handle it</span>
 <span class="mi">819</span>         <span class="k">if</span> <span class="p">(</span><span class="n">cpu</span><span class="o">-&gt;</span><span class="n">checkInterrupts</span><span class="p">(</span><span class="n">cpu</span><span class="o">-&gt;</span><span class="n">tcBase</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
 <span class="mi">820</span>             <span class="n">propagateInterrupt</span><span class="p">();</span>
 <span class="mi">821</span>     <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre> <span class="mi">788</span> <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Impl</span><span class="p">&gt;</span>
 <span class="mi">789</span> <span class="kt">void</span>
 <span class="mi">790</span> <span class="n">DefaultCommit</span><span class="o">&lt;</span><span class="n">Impl</span><span class="o">&gt;::</span><span class="n">propagateInterrupt</span><span class="p">()</span>
 <span class="mi">791</span> <span class="p">{</span>
 <span class="mi">792</span>     <span class="c1">// Don't propagate intterupts if we are currently handling a trap or</span>
 <span class="mi">793</span>     <span class="c1">// in draining and the last observable instruction has been committed.</span>
 <span class="mi">794</span>     <span class="k">if</span> <span class="p">(</span><span class="n">commitStatus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">TrapPending</span> <span class="o">||</span> <span class="n">interrupt</span> <span class="o">||</span> <span class="n">trapSquash</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span>
 <span class="mi">795</span>             <span class="n">tcSquash</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="n">drainImminent</span><span class="p">)</span>
 <span class="mi">796</span>         <span class="k">return</span><span class="p">;</span>
 <span class="mi">797</span> 
 <span class="mi">798</span>     <span class="c1">// Process interrupts if interrupts are enabled, not in PAL</span>
 <span class="mi">799</span>     <span class="c1">// mode, and no other traps or external squashes are currently</span>
 <span class="mi">800</span>     <span class="c1">// pending.</span>
 <span class="mi">801</span>     <span class="c1">// @todo: Allow other threads to handle interrupts.</span>
 <span class="mi">802</span> 
 <span class="mi">803</span>     <span class="c1">// Get any interrupt that happened</span>
 <span class="mi">804</span>     <span class="n">interrupt</span> <span class="o">=</span> <span class="n">cpu</span><span class="o">-&gt;</span><span class="n">getInterrupts</span><span class="p">();</span>
 <span class="mi">805</span> 
 <span class="mi">806</span>     <span class="c1">// Tell fetch that there is an interrupt pending.  This</span>
 <span class="mi">807</span>     <span class="c1">// will make fetch wait until it sees a non PAL-mode PC,</span>
 <span class="mi">808</span>     <span class="c1">// at which point it stops fetching instructions.</span>
 <span class="mi">809</span>     <span class="k">if</span> <span class="p">(</span><span class="n">interrupt</span> <span class="o">!=</span> <span class="n">NoFault</span><span class="p">)</span>
 <span class="mi">810</span>         <span class="n">toIEW</span><span class="o">-&gt;</span><span class="n">commitInfo</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">interruptPending</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
 <span class="mi">811</span> <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>If the commit stage found that the interrupt needs to be handled,
through the getInterrupts function,
it should first send signal to IEW stage and 
prevent further instruction fetching until the interrupt is resolved.</p>

<h3 id="handle-interrupt-at-the-time-of-instruction-commit"><span class="me-2">Handle interrupt at the time of instruction commit</span><a href="#handle-interrupt-at-the-time-of-instruction-commit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>After commit stage checks possible squash on the threads and 
presence of interrupt, 
it tries to commit the instructions.</p>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre> <span class="mi">976</span> <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Impl</span><span class="p">&gt;</span>
 <span class="mi">977</span> <span class="kt">void</span>
 <span class="mi">978</span> <span class="n">DefaultCommit</span><span class="o">&lt;</span><span class="n">Impl</span><span class="o">&gt;::</span><span class="n">commitInsts</span><span class="p">()</span>
 <span class="mi">979</span> <span class="p">{</span>
 <span class="mi">980</span>     <span class="c1">////////////////////////////////////</span>
 <span class="mi">981</span>     <span class="c1">// Handle commit</span>
 <span class="mi">982</span>     <span class="c1">// Note that commit will be handled prior to putting new</span>
 <span class="mi">983</span>     <span class="c1">// instructions in the ROB so that the ROB only tries to commit</span>
 <span class="mi">984</span>     <span class="c1">// instructions it has in this current cycle, and not instructions</span>
 <span class="mi">985</span>     <span class="c1">// it is writing in during this cycle.  Can't commit and squash</span>
 <span class="mi">986</span>     <span class="c1">// things at the same time...</span>
 <span class="mi">987</span>     <span class="c1">////////////////////////////////////</span>
 <span class="mi">988</span> 
 <span class="mi">989</span>     <span class="n">DPRINTF</span><span class="p">(</span><span class="n">Commit</span><span class="p">,</span> <span class="s">"Trying to commit instructions in the ROB.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
 <span class="mi">990</span> 
 <span class="mi">991</span>     <span class="kt">unsigned</span> <span class="n">num_committed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="mi">992</span> 
 <span class="mi">993</span>     <span class="n">DynInstPtr</span> <span class="n">head_inst</span><span class="p">;</span>
 <span class="mi">994</span> 
 <span class="mi">995</span>     <span class="c1">// Commit as many instructions as possible until the commit bandwidth</span>
 <span class="mi">996</span>     <span class="c1">// limit is reached, or it becomes impossible to commit any more.</span>
 <span class="mi">997</span>     <span class="k">while</span> <span class="p">(</span><span class="n">num_committed</span> <span class="o">&lt;</span> <span class="n">commitWidth</span><span class="p">)</span> <span class="p">{</span>
 <span class="mi">998</span>         <span class="c1">// Check for any interrupt that we've already squashed for</span>
 <span class="mi">999</span>         <span class="c1">// and start processing it.</span>
<span class="mi">1000</span>         <span class="k">if</span> <span class="p">(</span><span class="n">interrupt</span> <span class="o">!=</span> <span class="n">NoFault</span><span class="p">)</span>
<span class="mi">1001</span>             <span class="n">handleInterrupt</span><span class="p">();</span>
</pre></td></tr></tbody></table></code></div></div>

<p>If there were pending interrupt, the instructions cannot be committed.</p>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre></td><td class="rouge-code"><pre> <span class="mi">734</span> <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Impl</span><span class="p">&gt;</span>
 <span class="mi">735</span> <span class="kt">void</span>
 <span class="mi">736</span> <span class="n">DefaultCommit</span><span class="o">&lt;</span><span class="n">Impl</span><span class="o">&gt;::</span><span class="n">handleInterrupt</span><span class="p">()</span>
 <span class="mi">737</span> <span class="p">{</span>
 <span class="mi">738</span>     <span class="c1">// Verify that we still have an interrupt to handle</span>
 <span class="mi">739</span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">cpu</span><span class="o">-&gt;</span><span class="n">checkInterrupts</span><span class="p">(</span><span class="n">cpu</span><span class="o">-&gt;</span><span class="n">tcBase</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span> <span class="p">{</span>
 <span class="mi">740</span>         <span class="n">DPRINTF</span><span class="p">(</span><span class="n">Commit</span><span class="p">,</span> <span class="s">"Pending interrupt is cleared by master before "</span>
 <span class="mi">741</span>                 <span class="s">"it got handled. Restart fetching from the orig path.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
 <span class="mi">742</span>         <span class="n">toIEW</span><span class="o">-&gt;</span><span class="n">commitInfo</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">clearInterrupt</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
 <span class="mi">743</span>         <span class="n">interrupt</span> <span class="o">=</span> <span class="n">NoFault</span><span class="p">;</span>
 <span class="mi">744</span>         <span class="n">avoidQuiesceLiveLock</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
 <span class="mi">745</span>         <span class="k">return</span><span class="p">;</span>
 <span class="mi">746</span>     <span class="p">}</span>
 <span class="mi">747</span> 
 <span class="mi">748</span>     <span class="c1">// Wait until all in flight instructions are finished before enterring</span>
 <span class="mi">749</span>     <span class="c1">// the interrupt.</span>
 <span class="mi">750</span>     <span class="nf">if</span> <span class="p">(</span><span class="n">canHandleInterrupts</span> <span class="o">&amp;&amp;</span> <span class="n">cpu</span><span class="o">-&gt;</span><span class="n">instList</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
 <span class="mi">751</span>         <span class="c1">// Squash or record that I need to squash this cycle if</span>
 <span class="mi">752</span>         <span class="c1">// an interrupt needed to be handled.</span>
 <span class="mi">753</span>         <span class="n">DPRINTF</span><span class="p">(</span><span class="n">Commit</span><span class="p">,</span> <span class="s">"Interrupt detected.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
 <span class="mi">754</span> 
 <span class="mi">755</span>         <span class="c1">// Clear the interrupt now that it's going to be handled</span>
 <span class="mi">756</span>         <span class="n">toIEW</span><span class="o">-&gt;</span><span class="n">commitInfo</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">clearInterrupt</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
 <span class="mi">757</span> 
 <span class="mi">758</span>         <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="kr">thread</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">noSquashFromTC</span><span class="p">);</span>
 <span class="mi">759</span>         <span class="kr">thread</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">noSquashFromTC</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
 <span class="mi">760</span> 
 <span class="mi">761</span>         <span class="k">if</span> <span class="p">(</span><span class="n">cpu</span><span class="o">-&gt;</span><span class="n">checker</span><span class="p">)</span> <span class="p">{</span>
 <span class="mi">762</span>             <span class="n">cpu</span><span class="o">-&gt;</span><span class="n">checker</span><span class="o">-&gt;</span><span class="n">handlePendingInt</span><span class="p">();</span>
 <span class="mi">763</span>         <span class="p">}</span>
 <span class="mi">764</span> 
 <span class="mi">765</span>         <span class="c1">// CPU will handle interrupt. Note that we ignore the local copy of</span>
 <span class="mi">766</span>         <span class="c1">// interrupt. This is because the local copy may no longer be the</span>
 <span class="mi">767</span>         <span class="c1">// interrupt that the interrupt controller thinks is being handled.</span>
 <span class="mi">768</span>         <span class="n">cpu</span><span class="o">-&gt;</span><span class="n">processInterrupts</span><span class="p">(</span><span class="n">cpu</span><span class="o">-&gt;</span><span class="n">getInterrupts</span><span class="p">());</span>
 <span class="mi">769</span> 
 <span class="mi">770</span>         <span class="kr">thread</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">noSquashFromTC</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
 <span class="mi">771</span> 
 <span class="mi">772</span>         <span class="n">commitStatus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">TrapPending</span><span class="p">;</span>
 <span class="mi">773</span> 
 <span class="mi">774</span>         <span class="n">interrupt</span> <span class="o">=</span> <span class="n">NoFault</span><span class="p">;</span>
 <span class="mi">775</span> 
 <span class="mi">776</span>         <span class="c1">// Generate trap squash event.</span>
 <span class="mi">777</span>         <span class="nf">generateTrapEvent</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">interrupt</span><span class="p">);</span>
 <span class="mi">778</span> 
 <span class="mi">779</span>         <span class="n">avoidQuiesceLiveLock</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
 <span class="mi">780</span>     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
 <span class="mi">781</span>         <span class="n">DPRINTF</span><span class="p">(</span><span class="n">Commit</span><span class="p">,</span> <span class="s">"Interrupt pending: instruction is %sin "</span>
 <span class="mi">782</span>                 <span class="s">"flight, ROB is %sempty</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span>
 <span class="mi">783</span>                 <span class="n">canHandleInterrupts</span> <span class="o">?</span> <span class="s">"not "</span> <span class="o">:</span> <span class="s">""</span><span class="p">,</span>
 <span class="mi">784</span>                 <span class="n">cpu</span><span class="o">-&gt;</span><span class="n">instList</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">?</span> <span class="s">""</span> <span class="o">:</span> <span class="s">"not "</span> <span class="p">);</span>
 <span class="mi">785</span>     <span class="p">}</span>
 <span class="mi">786</span> <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="architecture-dependent-interrupt-checking"><span class="me-2">Architecture dependent interrupt checking</span><a href="#architecture-dependent-interrupt-checking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="mi">614</span> <span class="kt">bool</span>
<span class="mi">615</span> <span class="n">X86ISA</span><span class="o">::</span><span class="n">Interrupts</span><span class="o">::</span><span class="n">checkInterrupts</span><span class="p">(</span><span class="n">ThreadContext</span> <span class="o">*</span><span class="n">tc</span><span class="p">)</span> <span class="k">const</span>
<span class="mi">616</span> <span class="p">{</span>
<span class="mi">617</span>     <span class="n">RFLAGS</span> <span class="n">rflags</span> <span class="o">=</span> <span class="n">tc</span><span class="o">-&gt;</span><span class="n">readMiscRegNoEffect</span><span class="p">(</span><span class="n">MISCREG_RFLAGS</span><span class="p">);</span>
<span class="mi">618</span>     <span class="k">if</span> <span class="p">(</span><span class="n">pendingUnmaskableInt</span><span class="p">)</span> <span class="p">{</span>
<span class="mi">619</span>         <span class="n">DPRINTF</span><span class="p">(</span><span class="n">LocalApic</span><span class="p">,</span> <span class="s">"Reported pending unmaskable interrupt.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="mi">620</span>         <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="mi">621</span>     <span class="p">}</span>
<span class="mi">622</span>     <span class="nf">if</span> <span class="p">(</span><span class="n">rflags</span><span class="p">.</span><span class="n">intf</span><span class="p">)</span> <span class="p">{</span>
<span class="mi">623</span>         <span class="k">if</span> <span class="p">(</span><span class="n">pendingExtInt</span><span class="p">)</span> <span class="p">{</span>
<span class="mi">624</span>             <span class="n">DPRINTF</span><span class="p">(</span><span class="n">LocalApic</span><span class="p">,</span> <span class="s">"Reported pending external interrupt.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="mi">625</span>             <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="mi">626</span>         <span class="p">}</span>
<span class="mi">627</span>         <span class="nf">if</span> <span class="p">(</span><span class="n">IRRV</span> <span class="o">&gt;</span> <span class="n">ISRV</span> <span class="o">&amp;&amp;</span> <span class="n">bits</span><span class="p">(</span><span class="n">IRRV</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&gt;</span>
<span class="mi">628</span>                <span class="n">bits</span><span class="p">(</span><span class="n">regs</span><span class="p">[</span><span class="n">APIC_TASK_PRIORITY</span><span class="p">],</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="p">{</span>
<span class="mi">629</span>             <span class="n">DPRINTF</span><span class="p">(</span><span class="n">LocalApic</span><span class="p">,</span> <span class="s">"Reported pending regular interrupt.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="mi">630</span>             <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="mi">631</span>         <span class="p">}</span>
<span class="mi">632</span>     <span class="p">}</span>
<span class="mi">633</span>     <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="mi">634</span> <span class="p">}</span>

</pre></td></tr></tbody></table></code></div></div>

<h3 id="processing-interrupt-through-invoke"><span class="me-2">Processing interrupt through invoke</span><a href="#processing-interrupt-through-invoke" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre> <span class="mi">886</span> <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Impl</span><span class="p">&gt;</span>
 <span class="mi">887</span> <span class="kt">void</span>    
 <span class="mi">888</span> <span class="n">FullO3CPU</span><span class="o">&lt;</span><span class="n">Impl</span><span class="o">&gt;::</span><span class="n">processInterrupts</span><span class="p">(</span><span class="k">const</span> <span class="n">Fault</span> <span class="o">&amp;</span><span class="n">interrupt</span><span class="p">)</span>
 <span class="mi">889</span> <span class="p">{</span>       
 <span class="mi">890</span>     <span class="c1">// Check for interrupts here.  For now can copy the code that</span>
 <span class="mi">891</span>     <span class="c1">// exists within isa_fullsys_traits.hh.  Also assume that thread 0</span>
 <span class="mi">892</span>     <span class="c1">// is the one that handles the interrupts.</span>
 <span class="mi">893</span>     <span class="c1">// @todo: Possibly consolidate the interrupt checking code.</span>
 <span class="mi">894</span>     <span class="c1">// @todo: Allow other threads to handle interrupts.</span>
 <span class="mi">895</span>         
 <span class="mi">896</span>     <span class="n">assert</span><span class="p">(</span><span class="n">interrupt</span> <span class="o">!=</span> <span class="n">NoFault</span><span class="p">);</span>
 <span class="mi">897</span>     <span class="k">this</span><span class="o">-&gt;</span><span class="n">interrupts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">updateIntrInfo</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">threadContexts</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
 <span class="mi">898</span>         
 <span class="mi">899</span>     <span class="n">DPRINTF</span><span class="p">(</span><span class="n">O3CPU</span><span class="p">,</span> <span class="s">"Interrupt %s being handled</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">interrupt</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">());</span>
 <span class="mi">900</span>     <span class="k">this</span><span class="o">-&gt;</span><span class="n">trap</span><span class="p">(</span><span class="n">interrupt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">);</span>
 <span class="mi">901</span> <span class="p">}</span>       
 <span class="mi">902</span>
 <span class="mi">903</span> <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Impl</span><span class="p">&gt;</span>
 <span class="mi">904</span> <span class="kt">void</span>
 <span class="mi">905</span> <span class="n">FullO3CPU</span><span class="o">&lt;</span><span class="n">Impl</span><span class="o">&gt;::</span><span class="n">trap</span><span class="p">(</span><span class="k">const</span> <span class="n">Fault</span> <span class="o">&amp;</span><span class="n">fault</span><span class="p">,</span> <span class="n">ThreadID</span> <span class="n">tid</span><span class="p">,</span>
 <span class="mi">906</span>                       <span class="k">const</span> <span class="n">StaticInstPtr</span> <span class="o">&amp;</span><span class="n">inst</span><span class="p">)</span>
 <span class="mi">907</span> <span class="p">{</span>       
 <span class="mi">908</span>     <span class="c1">// Pass the thread's TC into the invoke method.</span>
 <span class="mi">909</span>     <span class="n">fault</span><span class="o">-&gt;</span><span class="n">invoke</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">threadContexts</span><span class="p">[</span><span class="n">tid</span><span class="p">],</span> <span class="n">inst</span><span class="p">);</span>
 <span class="mi">910</span> <span class="p">}</span>      
</pre></td></tr></tbody></table></code></div></div>

<h3 id="generate-trap-event"><span class="me-2">Generate trap event</span><a href="#generate-trap-event" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre> <span class="mi">526</span> <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Impl</span><span class="p">&gt;</span>
 <span class="mi">527</span> <span class="kt">void</span>
 <span class="mi">528</span> <span class="n">DefaultCommit</span><span class="o">&lt;</span><span class="n">Impl</span><span class="o">&gt;::</span><span class="n">generateTrapEvent</span><span class="p">(</span><span class="n">ThreadID</span> <span class="n">tid</span><span class="p">,</span> <span class="n">Fault</span> <span class="n">inst_fault</span><span class="p">)</span>
 <span class="mi">529</span> <span class="p">{</span>
 <span class="mi">530</span>     <span class="n">DPRINTF</span><span class="p">(</span><span class="n">Commit</span><span class="p">,</span> <span class="s">"Generating trap event for [tid:%i]</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">tid</span><span class="p">);</span>
 <span class="mi">531</span> 
 <span class="mi">532</span>     <span class="n">EventFunctionWrapper</span> <span class="o">*</span><span class="n">trap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">EventFunctionWrapper</span><span class="p">(</span>
 <span class="mi">533</span>         <span class="p">[</span><span class="k">this</span><span class="p">,</span> <span class="n">tid</span><span class="p">]{</span> <span class="n">processTrapEvent</span><span class="p">(</span><span class="n">tid</span><span class="p">);</span> <span class="p">},</span>
 <span class="mi">534</span>         <span class="s">"Trap"</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="n">Event</span><span class="o">::</span><span class="n">CPU_Tick_Pri</span><span class="p">);</span>
 <span class="mi">535</span> 
 <span class="mi">536</span>     <span class="n">Cycles</span> <span class="n">latency</span> <span class="o">=</span> <span class="n">dynamic_pointer_cast</span><span class="o">&lt;</span><span class="n">SyscallRetryFault</span><span class="o">&gt;</span><span class="p">(</span><span class="n">inst_fault</span><span class="p">)</span> <span class="o">?</span>
 <span class="mi">537</span>                      <span class="n">cpu</span><span class="o">-&gt;</span><span class="n">syscallRetryLatency</span> <span class="o">:</span> <span class="n">trapLatency</span><span class="p">;</span>
 <span class="mi">538</span> 
 <span class="mi">539</span>     <span class="n">cpu</span><span class="o">-&gt;</span><span class="n">schedule</span><span class="p">(</span><span class="n">trap</span><span class="p">,</span> <span class="n">cpu</span><span class="o">-&gt;</span><span class="n">clockEdge</span><span class="p">(</span><span class="n">latency</span><span class="p">));</span>
 <span class="mi">540</span>     <span class="n">trapInFlight</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
 <span class="mi">541</span>     <span class="kr">thread</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">trapPending</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
 <span class="mi">542</span> <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    

    <!-- tags -->
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a
        href="https://twitter.com/intent/tweet?text=Gem5%20Interrupt%20Handling%20O3%20-%20Ruach&url=https%3A%2F%2Fruach.github.io%2Fposts%2Fgem5-interrupt-handling-o3%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Twitter"
        target="_blank"
        rel="noopener"
        aria-label="Twitter"
      >
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a
        href="https://www.facebook.com/sharer/sharer.php?title=Gem5%20Interrupt%20Handling%20O3%20-%20Ruach&u=https%3A%2F%2Fruach.github.io%2Fposts%2Fgem5-interrupt-handling-o3%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Facebook"
        target="_blank"
        rel="noopener"
        aria-label="Facebook"
      >
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a
        href="https://t.me/share/url?url=https%3A%2F%2Fruach.github.io%2Fposts%2Fgem5-interrupt-handling-o3%2F&text=Gem5%20Interrupt%20Handling%20O3%20-%20Ruach"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Telegram"
        target="_blank"
        rel="noopener"
        aria-label="Telegram"
      >
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

      

      <a
        href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fruach.github.io%2Fposts%2Fgem5-interrupt-handling-o3%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Linkedin"
        target="_blank"
        rel="noopener"
        aria-label="Linkedin"
      >
        <i class="fa-fw fab fa-linkedin"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get the last 5 posts from lastmod list. -->















              <!-- The trending tags list -->


















            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->

























            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/basecpu/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Basecpu</p>
    </a>
  

  
    <a
      href="/posts/TDX-SEAMLDR/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>TDX Module Life Cycle Part 0 (SEAMLDR)</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->

  
  <!-- The Disqus lazy loading. -->

<div id="disqus_thread">
  <p class="text-center text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p>
</div>

<script type="text/javascript">
  var disqus_config = function () {
    this.page.url = 'https://ruach.github.io/posts/gem5-interrupt-handling-o3/';
    this.page.identifier = '/posts/gem5-interrupt-handling-o3/';
  };

  /* Lazy loading */
  var disqus_observer = new IntersectionObserver(
    function (entries) {
      if (entries[0].isIntersecting) {
        (function () {
          var d = document,
            s = d.createElement('script');
          s.src = 'https://ruach.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();

        disqus_observer.disconnect();
      }
    },
    { threshold: [0] }
  );

  disqus_observer.observe(document.querySelector('#disqus_thread'));

  /* Auto switch theme */
  function reloadDisqus() {
    if (event.source === window && event.data && event.data.direction === ModeToggle.ID) {
      /* Disqus hasn't been loaded */
      if (typeof DISQUS === 'undefined') {
        return;
      }

      if (document.readyState == 'complete') {
        DISQUS.reset({ reload: true, config: disqus_config });
      }
    }
  }

  if (document.querySelector('.mode-toggle')) {
    window.addEventListener('message', reloadDisqus);
  }
</script>



            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    ©
    <time>2024</time>
    <a href="https://ruach.github.io">Jaehyuk Lee</a>.
    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->


















    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.21.2/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

